# üñºÔ∏è image_processor

–õ—ë–≥–∫–∏–π –∏ –±—ã—Å—Ç—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞ C++17 –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ BMP-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É.  
–†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---
## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–í—Ö–æ–¥–Ω—ã–µ –∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ [BMP](http://en.wikipedia.org/wiki/BMP_file_format).

–§–æ—Ä–º–∞—Ç BMP –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞—Ü–∏–π, –Ω–æ –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
24-–±–∏—Ç–Ω—ã–π BMP –±–µ–∑ —Å–∂–∞—Ç–∏—è –∏ –±–µ–∑ —Ç–∞–±–ª–∏—Ü—ã —Ü–≤–µ—Ç–æ–≤. –¢–∏–ø –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ `DIB header` - `BITMAPINFOHEADER`.

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –Ω—É–∂–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –µ—Å—Ç—å –≤ —Å—Ç–∞—Ç—å–µ –Ω–∞ –í–∏–∫–∏–ø–µ–¥–∏–∏ [–≤ —Ä–∞–∑–¥–µ–ª–µ "Example 1"](https://en.wikipedia.org/wiki/BMP_file_format#Example_1)

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ–±—ã —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
–±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏–º–µ–Ω–Ω–æ –≤ 24-–±–∏—Ç–Ω–æ–º BMP.

## –§–æ—Ä–º–∞—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:

`{–∏–º—è –ø—Ä–æ–≥—Ä–∞–º–º—ã} {–ø—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É} {–ø—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É}
[-{–∏–º—è —Ñ–∏–ª—å—Ç—Ä–∞ 1} [–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ–∏–ª—å—Ç—Ä–∞ 1] [–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ–∏–ª—å—Ç—Ä–∞ 2] ...]
[-{–∏–º—è —Ñ–∏–ª—å—Ç—Ä–∞ 2} [–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ–∏–ª—å—Ç—Ä–∞ 1] [–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ–∏–ª—å—Ç—Ä–∞ 2] ...] ...`

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–æ–¥–∏—Ç —Å–ø—Ä–∞–≤–∫—É.

### –°–ø–∏—Å–æ–∫ –±–∞–∑–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

#### Crop (-crop width height)
–û–±—Ä–µ–∑–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ –∑–∞–¥–∞–Ω–Ω—ã—Ö —à–∏—Ä–∏–Ω—ã –∏ –≤—ã—Å–æ—Ç—ã. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä—Ö–Ω—è—è –ª–µ–≤–∞—è —á–∞—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–µ —à–∏—Ä–∏–Ω–∞ –∏–ª–∏ –≤—ã—Å–æ—Ç–∞ –ø—Ä–µ–≤—ã—à–∞—é—Ç —Ä–∞–∑–º–µ—Ä—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—ã–¥–∞–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–∞—è —á–∞—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

#### Grayscale (-gs)
–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ –ø–æ —Ñ–æ—Ä–º—É–ª–µ

$$
R' = G' = B' = 0.299R + 0.587G + 0.114B
$$


#### Negative (-neg)
–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –Ω–µ–≥–∞—Ç–∏–≤ –ø–æ —Ñ–æ—Ä–º—É–ª–µ

$$
R' = 1 - R, \quad G' = 1 - G, \quad B' = 1 - B
$$

#### Sharpening (-sharp)
–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ä–µ–∑–∫–æ—Å—Ç–∏. –î–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∞—Ç—Ä–∏—Ü—ã

$$
\begin{bmatrix}
  & -1 &  \\
-1 & 5 & -1 \\
  & -1 & 
\end{bmatrix}
$$

#### Edge Detection (-edge threshold)
–í—ã–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞

$$
\begin{bmatrix}
  & -1 &  \\
-1 & 4 & -1 \\
  & -1 & 
\end{bmatrix}
$$


–ü–∏–∫—Å–µ–ª–∏ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º, –ø—Ä–µ–≤—ã—Å–∏–≤—à–∏–º `threshold`, –æ–∫—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –≤ –±–µ–ª—ã–π, –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äì –≤ —á–µ—Ä–Ω—ã–π.

#### Gaussian Blur (-blur sigma)
[–ì–∞—É—Å—Å–æ–≤–æ —Ä–∞–∑–º—ã—Ç–∏–µ](https://ru.wikipedia.org/wiki/–†–∞–∑–º—ã—Ç–∏–µ_–ø–æ_–ì–∞—É—Å—Å—É),
–ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äì —Å–∏–≥–º–∞.

–ó–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ü–≤–µ—Ç–æ–≤ –ø–∏–∫—Å–µ–ª—è `C[x0][y0]` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ñ–æ—Ä–º—É–ª–æ–π

$$
C[x_0][y_0] = \sum_{x=0,\,y=0}^{width-1,\,height-1} C[x][y] \frac{1}{2\pi\sigma^2} e^{-\frac{(x_0-x)^2 + (y_0-y)^2}{2\sigma^2}}
$$


–°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–ª–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –æ–ø–∏—Å–∞–Ω–∏–µ –µ—Å—Ç—å [–≤ –í–∏–∫–∏–ø–µ–¥–∏–∏](https://ru.wikipedia.org/wiki/–†–∞–∑–º—ã—Ç–∏–µ_–ø–æ_–ì–∞—É—Å—Å—É).

### Pixelate (block_size)
–ü–∏–∫—Å–µ–ª–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
image_processor/
‚îú‚îÄ‚îÄ filters/              # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
‚îú‚îÄ‚îÄ image/                # –ö–ª–∞—Å—Å Image –∏ —Å–ª—É–∂–µ–±–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ parser/               # –ü–∞—Ä—Å–∏–Ω–≥ CLI-–∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ reading_and_writing/  # –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å BMP
‚îú‚îÄ‚îÄ test_script/          # –°–∫—Ä–∏–ø—Ç—ã –∏ JSON –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ utils.h               # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ CMakeLists.txt        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ image_processor       # –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CLion)
‚îú‚îÄ‚îÄ unit_tests            # –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã Catch2
‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üõ†Ô∏è –°–±–æ—Ä–∫–∞

git clone https://github.com/Nikkfh5/image_processor.git

cd image_processor

mkdir build && cd build

cmake ..

cmake --build ..

### –ü—Ä–∏–º–µ—Ä

–ü–µ—Ä–µ–≤–æ–¥ –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ
./image_processor photos/cat.bmp out/cat_gs.bmp -gs

–û–±—Ä–µ–∑–∫–∞ –¥–æ 400√ó300 –∏ —Ä–∞–∑–º—ã—Ç–∏–µ
./image_processor in.bmp out.bmp -crop 400 300 -blur 2.0

–ü–∏–∫—Å–µ–ª–∏–∑–∞—Ü–∏—è + –Ω–µ–≥–∞—Ç–∏–≤
./image_processor in.bmp out.bmp -pixelate 12 -neg


`./image_processor input.bmp /tmp/output.bmp -crop 800 600 -gs -blur 0.5`

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞ `input.bmp`
2. –û–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –Ω–∞—á–∞–ª–æ–º –≤ –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É –∏ —Ä–∞–∑–º–µ—Ä–æ–º 800—Ö600 –ø–∏–∫—Å–µ–ª–µ–π
3. –ü–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ
4. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ä–∞–∑–º—ã—Ç–∏–µ —Å —Å–∏–≥–º–æ–π 0.5
5. –ü–æ–ª—É—á–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `/tmp/output.bmp`

–°–ø–∏—Å–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç, —Ç–æ–≥–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–º –≤–∏–¥–µ.
–§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

## –§–∏–ª—å—Ç—Ä—ã

–í —Ñ–æ—Ä–º—É–ª–∞—Ö –¥–∞–ª–µ–µ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –∫–∞–∂–¥–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Ü–≤–µ—Ç–∞
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 1. –¶–≤–µ—Ç–∞ –ø–∏–∫—Å–µ–ª–µ–π
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç—Ä–æ–π–∫–∞–º–∏ `(R, G, B)`. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `(0, 0, 0)` ‚Äì —á–µ—Ä–Ω—ã–π,
`(1, 1, 1)` ‚Äì –±–µ–ª—ã–π.

–ï—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä –∑–∞–¥–∞–Ω –º–∞—Ç—Ä–∏—Ü–µ–π, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ü–≤–µ—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Å—É–º–º–æ–π
–∑–Ω–∞—á–µ–Ω–∏–π —ç—Ç–æ–≥–æ —Ü–≤–µ—Ç–∞ –≤ —Å–æ—Å–µ–¥–Ω–∏—Ö –ø–∏–∫—Å–µ–ª—è—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –º–∞—Ç—Ä–∏—Ü–µ–π. –ü—Ä–∏ —ç—Ç–æ–º —Ü–µ–ª–µ–≤–æ–º—É –ø–∏–∫—Å–µ–ª—é
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Ç—Ä–∏—Ü—ã.


–°–æ–∑–¥–∞–Ω –∫–∞–∫ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –Ω–æ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –ø–æ–¥ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

